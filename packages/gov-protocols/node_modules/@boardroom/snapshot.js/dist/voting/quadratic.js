!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).snapshot={})}(this,(function(e){"use strict";function t(e,t){var n=e/t.reduce((function(e,t){return e+t}),0);return isNaN(n)?0:n}function n(e,t){return Math.sqrt(e*t)}function r(e){return e*e}function o(e,t){return e.map((function(e){return t*e}))}var u=function(){function e(e,t,n,r){this.proposal=e,this.votes=t,this.strategies=n,this.selected=r}return e.isValidChoice=function(e,t){return"object"==typeof e&&!Array.isArray(e)&&null!==e&&Object.keys(e).every((function(e){return void 0!==(null==t?void 0:t[Number(e)-1])}))&&Object.keys(e).length>0&&Object.values(e).every((function(e){return"number"==typeof e&&e>=0}))&&Object.values(e).some((function(e){return"number"==typeof e&&e>0}))},e.prototype.getValidVotes=function(){var t=this;return this.votes.filter((function(n){return e.isValidChoice(n.choice,t.proposal.choices)}))},e.prototype.getScores=function(){var e=this.getValidVotes(),u=this.getValidVotes().reduce((function(e,t){return e+t.balance}),0),i=this.proposal.choices.map((function(o,u){return r(e.map((function(e){return n(t(e.choice[u+1],Object.values(e.choice)),e.balance)})).reduce((function(e,t){return e+t}),0))}));return o(i.map((function(e,n){return t(i[n],i)})),u)},e.prototype.getScoresByStrategy=function(){var e=this,u=this.getValidVotes(),i=this.getValidVotes().reduce((function(e,t){return e+t.balance}),0),c=this.proposal.choices.map((function(r,o){return e.strategies.map((function(e,r){return u.map((function(e){return n(t(e.choice[o+1],Object.values(e.choice)),e.scores[r])})).reduce((function(e,t){return e+t}),0)}))})).map((function(e){return e.map((function(e){return[r(e)]}))}));return c.map((function(n,r){return o(e.strategies.map((function(e,n){return t(c[r][n][0],c.flat(2))})),i)}))},e.prototype.getScoresTotal=function(){return this.votes.reduce((function(e,t){return e+t.balance}),0)},e.prototype.getChoiceString=function(){var e=this;return this.proposal.choices.map((function(n,r){if(e.selected[r+1]){var o=t(e.selected[r+1],Object.values(e.selected));return Math.round(1e3*o)/10+"% for "+n}})).filter((function(e){return null!=e})).join(", ")},e}();e.calcPercentageOfSum=t,e.calcSqrt=n,e.default=u,Object.defineProperty(e,"__esModule",{value:!0})}));
