!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).snapshot={})}(this,(function(e){"use strict";function t(e,t,n){var r=n.reduce((function(e,t){return e+t}),0),o=t[e]/r*100;return isNaN(o)?0:o}function n(e,n,r){return t(e+1,n,Object.values(n))/100*r}var r=function(){function e(e,t,n,r){this.proposal=e,this.votes=t,this.strategies=n,this.selected=r}return e.isValidChoice=function(e,t){return"object"==typeof e&&!Array.isArray(e)&&null!==e&&Object.keys(e).every((function(e){return void 0!==(null==t?void 0:t[Number(e)-1])}))&&Object.keys(e).length>0&&Object.values(e).every((function(e){return"number"==typeof e&&e>=0}))&&Object.values(e).some((function(e){return"number"==typeof e&&e>0}))},e.prototype.getValidVotes=function(){var t=this;return this.votes.filter((function(n){return e.isValidChoice(n.choice,t.proposal.choices)}))},e.prototype.getScores=function(){var e=this,r=this.proposal.choices.map((function(t,r){return e.getValidVotes().map((function(e){return n(r,e.choice,e.balance)})).reduce((function(e,t){return e+t}),0)})),o=this.getValidVotes().reduce((function(e,t){return e+t.balance}),0);return r.map((function(e,n){return t(n,r,r)})).map((function(e){return o/100*e}))},e.prototype.getScoresByStrategy=function(){var e=this,r=this.proposal.choices.map((function(t,r){return e.strategies.map((function(t,o){return e.getValidVotes().map((function(e){return n(r,e.choice,e.scores[o])})).reduce((function(e,t){return e+t}),0)}))})).map((function(e){return e.map((function(e){return[e]}))})),o=this.getValidVotes().reduce((function(e,t){return e+t.balance}),0);return r.map((function(n,i){return e.strategies.map((function(e,n){return t(0,r[i][n],r.flat(2))})).map((function(e){return[o/100*e]})).flat()}))},e.prototype.getScoresTotal=function(){return this.votes.reduce((function(e,t){return e+t.balance}),0)},e.prototype.getChoiceString=function(){var e=this;return this.proposal.choices.map((function(n,r){if(e.selected[r+1])return Math.round(10*t(r+1,e.selected,Object.values(e.selected)))/10+"% for "+n})).filter((function(e){return null!=e})).join(", ")},e}();e.default=r,e.percentageOfTotal=t,e.weightedPower=n,Object.defineProperty(e,"__esModule",{value:!0})}));
